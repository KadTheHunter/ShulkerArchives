"use strict";function updateSetting(e){updateOutput(),e=e instanceof Event?this:e||this,localStorage.setItem(e.id,"checkbox"===e.type?e.checked:e.value)}function loadSettings(){for(var e in settings){var t=settings[e],n=localStorage.getItem(t.id);null!==n&&("checkbox"===t.type?(t.checked="false"!==n,t.onclick()):(t.value=n,t.oninput()))}}function getNoteString(){return 0===notes.length?"":notes.join("\n")+"\n\n"}function validateNBT(){parsedData=void 0,notes=[];for(var e=input.value;/^\s*"/.test(e);){notes.push("NOTE: Input looks like a JSON string and will be unescaped.");try{e=JSON.parse(e)}catch(e){return void(output.value=getNoteString()+"ERROR while unescaping JSON: "+e.message)}notes[notes.length-1]="NOTE: Input looked like a JSON string and was unescaped."}try{parsedData=nbtlint.parse(e)}catch(e){return console.log(e),output.value=getNoteString()+e.message,void(e.suggestion&&(output.value+="\n\n"+e.suggestion))}updateOutput()}function updateOutput(){if(parsedData){var e=!1;settings.sortAlpha.checked&&settings.sortType.checked?e=nbtlint.compareTypeAlpha:settings.sortType.checked?e=nbtlint.compareType:settings.sortAlpha.checked&&(e=nbtlint.compareAlpha),output.value=getNoteString(),output.value+=nbtlint.stringify(parsedData,settings.spaces.checked?"        ".substr(0,+settings.indent.value):"\t",{nlBrackets:settings.nlBracket.checked,collapseBrackets:settings.collapseBracket.checked,expandPrimitives:!settings.collapsePrim.checked,trailingComma:settings.trailingComma.checked,sort:e,quoteKeys:settings.quoteKeys.checked,unquoteStrings:!settings.quoteStrings.checked,quoteChoice:settings.quoteChoice.value,boolChoice:settings.boolChoice.value,deflate:settings.deflate.checked,capitalizeSuffix:{l:settings.capitalL.checked,default:settings.capitalSuff.checked}})}}function loadLink(){var e=decodeURIComponent(location.hash.substr(1));e!==input.value&&(input.value=e,input.value?validateNBT():output.value="")}var parsedData,input=document.getElementById("in"),output=document.getElementById("out"),settings={deflate:document.getElementById("deflate"),spaces:document.getElementById("spaces"),indent:document.getElementById("indent"),nlBracket:document.getElementById("nlBracket"),collapseBracket:document.getElementById("collapseBracket"),collapsePrim:document.getElementById("collapsePrim"),trailingComma:document.getElementById("trailingComma"),sortType:document.getElementById("sortType"),sortAlpha:document.getElementById("sortAlpha"),quoteKeys:document.getElementById("quoteKeys"),quoteStrings:document.getElementById("quoteStrings"),quoteChoice:document.getElementById("quoteChoice"),boolChoice:document.getElementById("boolChoice"),capitalL:document.getElementById("capitalL"),capitalSuff:document.getElementById("capitalSuff")},notes=[];for(var name in settings){var el=settings[name];el["checkbox"===el.type?"onclick":"oninput"]=updateSetting}indent.oninput=function(){updateSetting(this);var e=settings.indent.value;1===e.length&&e>="0"&&e<="8"&&(document.body.className="tab-"+e)},loadSettings(),document.getElementById("validate").onclick=function(){location.hash="#"+input.value.replace(/[%\r\n\0]/g,function(e){var t=e.charCodeAt(0).toString(16);return t.length<2&&(t="0"+t),"%"+t}),validateNBT()},window.onhashchange=document.onhashchange=loadLink,loadLink();